{"ast":null,"code":"import _regeneratorRuntime from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/src/Register/index.js\";\nimport React, { Component } from 'react';\nimport { BrowserRouter as Router, Link } from 'react-router-dom';\nimport cloudinary from 'cloudinary-react';\nimport { Redirect } from 'react-router-dom';\nimport './style.css';\n\nvar Register =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Register, _Component);\n\n  function Register(props) {\n    var _this;\n\n    _classCallCheck(this, Register);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Register).call(this, props));\n\n    _this.updateInput = function (event) {\n      event.preventDefault();\n\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.updateFile = function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        profilePicture: event.target.files[0]\n      });\n    };\n\n    _this.isValid = function (event) {\n      event.preventDefault();\n      var isValid = false;\n      var emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      var specialCharacterPattern = /[!@()#$%&'*+/=?^_`{|}~-]+/;\n      var numberPattern = /\\d/;\n      var usernameMessageText;\n      var emailMessageText;\n      var passwordMessageText;\n\n      if (_this.state.username.length === 0) {\n        isValid = false;\n        usernameMessageText = 'A username is required for registration';\n      } else if (!emailRegex.exec(_this.state.email)) {\n        isValid = false;\n        emailMessageText = 'Email address is invalid!';\n      } else if (_this.state.password.length < 7 || !specialCharacterPattern.exec(_this.state.password) || !numberPattern.exec(_this.state.password)) {\n        isValid = false;\n        passwordMessageText = 'Password is invalid! Password must be at least 7 characters long and include at least one number and one special character';\n      } else {\n        isValid = true;\n      }\n\n      if (isValid && _this.state.profilePicture) {\n        _this.uploadFile();\n      }\n\n      _this.setState({\n        valid: isValid,\n        usernameMessage: usernameMessageText,\n        emailMessage: emailMessageText,\n        passwordMessage: passwordMessageText\n      });\n    };\n\n    _this.uploadFile =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var url, xhr, fd;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = 'https://api.cloudinary.com/v1_1/amhouel/upload';\n              xhr = new XMLHttpRequest();\n              fd = new FormData();\n              _context.next = 5;\n              return xhr.open('POST', url, true);\n\n            case 5:\n              xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n              fd.append('upload_preset', 'zm0ff4bo');\n              fd.append('file', _this.state.profilePicture);\n              fd.append('public_id', \"\".concat(_this.state.profilePicture.name, \"-\").concat(_this.state.username));\n              xhr.send(fd);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    _this.register =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var body, response, responseBody;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.preventDefault();\n                body = JSON.stringify({\n                  fullName: _this.state.fullName,\n                  dob: _this.state.dob ? _this.state.dob : null,\n                  address: _this.state.address,\n                  username: _this.state.username,\n                  profilePicture: _this.state.profilePicture ? \"\".concat(_this.state.profilePicture.name, \"-\").concat(_this.state.username) : null,\n                  email: _this.state.email,\n                  password: _this.state.password\n                });\n                _context2.next = 4;\n                return fetch('/api/register', {\n                  method: \"POST\",\n                  body: body,\n                  headers: {\n                    \"Content-Type\": \"application/json\"\n                  }\n                });\n\n              case 4:\n                response = _context2.sent;\n                _context2.next = 7;\n                return response.json();\n\n              case 7:\n                responseBody = _context2.sent;\n\n                if (!(response.status === 409)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                _this.setState({\n                  message: responseBody.message\n                });\n\n                return _context2.abrupt(\"return\");\n\n              case 11:\n                localStorage.setItem('user-jwt', responseBody.token);\n\n                _this.setState({\n                  redirectToReferrer: true\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      redirectToReferrer: false,\n      valid: false,\n      fullName: '',\n      dob: '',\n      address: '',\n      username: '',\n      profilePicture: '',\n      email: '',\n      password: '',\n      usernameMessage: '',\n      emailMessage: '',\n      passwordMessage: '',\n      message: ''\n    };\n    return _this;\n  }\n\n  _createClass(Register, [{\n    key: \"render\",\n    value: function render() {\n      var _ref3 = this.props.location.state || {\n        from: {\n          pathname: \"/volunteer\"\n        }\n      },\n          from = _ref3.from;\n\n      var redirectToReferrer = this.state.redirectToReferrer;\n\n      if (redirectToReferrer) {\n        return React.createElement(Redirect, {\n          to: from,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        });\n      } else {\n        return React.createElement(\"div\", {\n          className: \"register-wrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, React.createElement(\"form\", {\n          className: \"register-form\",\n          onSubmit: this.isValid,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"full-name-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, \"Full Name:\"), React.createElement(\"input\", {\n          className: \"full-name-input\",\n          type: \"text\",\n          placeholder: \"Full name\",\n          name: \"fullName\",\n          value: this.state.fullName,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          className: \"dob-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, \"Date of Birth:\"), React.createElement(\"input\", {\n          type: \"date\",\n          name: \"dob\",\n          value: this.state.dob,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          className: \"address-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, \"Address:\"), React.createElement(\"input\", {\n          className: \"address-input\",\n          type: \"text\",\n          name: \"address\",\n          placeholder: \"Address\",\n          value: this.state.address,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          className: \"email-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, \"Email:\"), React.createElement(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          placeholder: \"Email\",\n          value: this.state.email,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          className: \"validation-message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, this.state.emailMessage), React.createElement(\"label\", {\n          className: \"profile-picture-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, \"Profile Picture:\"), React.createElement(\"input\", {\n          type: \"file\",\n          name: \"profilePicture\",\n          onChange: this.updateFile,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          className: \"username-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, \"Username:\"), React.createElement(\"input\", {\n          className: \"username-input\",\n          type: \"text\",\n          name: \"username\",\n          placeholder: \"Username\",\n          value: this.state.username,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          className: \"validation-message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, this.state.usernameMessage), React.createElement(\"label\", {\n          className: \"password-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, \"Password:\"), React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          placeholder: \"Password\",\n          value: this.state.password,\n          onChange: this.updateInput,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          className: \"validation-message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, this.state.passwordMessage)), !this.state.valid && React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"ok-button\",\n          onClick: this.isValid,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, \"Ok\"), React.createElement(\"button\", {\n          className: \"cancel-register-button\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(Link, {\n          className: \"cancel-link\",\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"Cancel\"))), this.state.valid && React.createElement(\"button\", {\n          className: \"register-button\",\n          onClick: this.register,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, \"Register\"), this.state.message && React.createElement(\"p\", {\n          className: \"validation-message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, this.state.message));\n      }\n    }\n  }]);\n\n  return Register;\n}(Component);\n\nexport default Register;","map":{"version":3,"sources":["/Users/amhouel/wdi/unit04/projects/project-4-give-back-app/src/Register/index.js"],"names":["React","Component","BrowserRouter","Router","Link","cloudinary","Redirect","Register","props","updateInput","event","preventDefault","setState","target","name","value","updateFile","profilePicture","files","isValid","emailRegex","specialCharacterPattern","numberPattern","usernameMessageText","emailMessageText","passwordMessageText","state","username","length","exec","email","password","uploadFile","valid","usernameMessage","emailMessage","passwordMessage","url","xhr","XMLHttpRequest","fd","FormData","open","setRequestHeader","append","send","register","body","JSON","stringify","fullName","dob","address","fetch","method","headers","response","json","responseBody","status","message","localStorage","setItem","token","redirectToReferrer","location","from","pathname"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { BrowserRouter as Router, Link } from 'react-router-dom';\nimport cloudinary from 'cloudinary-react';\nimport { Redirect } from 'react-router-dom';\nimport './style.css';\n\n\nclass Register extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            redirectToReferrer: false,\n            valid: false,\n            fullName: '',\n            dob: '',\n            address: '',\n            username: '',\n            profilePicture: '',\n            email: '',\n            password: '',\n            usernameMessage: '',\n            emailMessage: '',\n            passwordMessage: '',\n            message: ''\n        }\n    }\n\n    updateInput = event => {\n        event.preventDefault();\n        this.setState({\n            [event.target.name]: event.target.value\n        });\n    }\n\n    // Code from \"React Image Upload Made Easy\" Youtube video\n    updateFile = event => {\n        event.preventDefault();\n        this.setState ({\n            profilePicture: event.target.files[0]\n        });\n    }\n\n    isValid = event => {\n        event.preventDefault();\n        let isValid = false;\n        let emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        let specialCharacterPattern = /[!@()#$%&'*+/=?^_`{|}~-]+/;\n        let numberPattern = /\\d/;\n        let usernameMessageText;\n        let emailMessageText;\n        let passwordMessageText;\n\n        if (this.state.username.length === 0) {\n        isValid = false;\n        usernameMessageText = 'A username is required for registration';\n        }\n        else if (!emailRegex.exec(this.state.email)) {\n        isValid = false;\n        emailMessageText = 'Email address is invalid!';\n        }\n        else if (this.state.password.length < 7 || !specialCharacterPattern.exec(this.state.password) || !numberPattern.exec(this.state.password)) {\n        isValid = false;\n        passwordMessageText = 'Password is invalid! Password must be at least 7 characters long and include at least one number and one special character';\n        } else {\n            isValid = true;\n        }\n\n        if(isValid && this.state.profilePicture){\n            this.uploadFile();\n        }\n\n        this.setState({\n        valid: isValid,\n        usernameMessage: usernameMessageText,\n        emailMessage: emailMessageText,\n        passwordMessage: passwordMessageText\n        });\n    }\n    \n    //Code from \"HTML5 upload (xhr) to Cloudinary\" Codepen\n    uploadFile = async() => {\n        const url = 'https://api.cloudinary.com/v1_1/amhouel/upload';\n        const xhr = new XMLHttpRequest();\n        const fd = new FormData();\n        await xhr.open('POST', url, true);\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        fd.append('upload_preset', 'zm0ff4bo');\n        fd.append('file', this.state.profilePicture);\n        fd.append('public_id', `${this.state.profilePicture.name}-${this.state.username}`);\n        xhr.send(fd);\n    }\n\n    register = async(event) => {\n        event.preventDefault();\n        const body = JSON.stringify({\n            fullName: this.state.fullName,\n            dob: this.state.dob? this.state.dob : null,\n            address: this.state.address,\n            username: this.state.username,\n            profilePicture:  this.state.profilePicture? `${this.state.profilePicture.name}-${this.state.username}`: null,\n            email: this.state.email,\n            password: this.state.password,\n        });\n        const response = await fetch('/api/register', {\n            method: \"POST\",\n            body: body,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n        const responseBody = await response.json();\n        if(response.status === 409){\n            this.setState({\n                message: responseBody.message\n            });\n            return;\n        }\n        localStorage.setItem('user-jwt', responseBody.token);\n        this.setState({\n            redirectToReferrer: true\n        });\n    }\n\n    render() {\n        const { from } = this.props.location.state || { from: { pathname: \"/volunteer\" } };\n        const { redirectToReferrer } = this.state;\n\n        if (redirectToReferrer) {\n            return <Redirect to={from} />;\n        } else {\n            return (\n                <div className=\"register-wrapper\">\n                    <form className=\"register-form\" onSubmit={this.isValid}>\n                        <label className=\"full-name-label\">Full Name:</label>\n                        <input className=\"full-name-input\" type=\"text\" placeholder=\"Full name\" name=\"fullName\" value={this.state.fullName} onChange={this.updateInput}/>\n                        <label className=\"dob-label\">Date of Birth:</label>\n                        <input type=\"date\" name=\"dob\" value={this.state.dob} onChange={this.updateInput}/>\n                        <label className=\"address-label\">Address:</label>\n                        <input className=\"address-input\" type=\"text\" name=\"address\" placeholder=\"Address\" value={this.state.address} onChange={this.updateInput}/>\n                        <label className=\"email-label\">Email:</label>\n                        <input type=\"email\" name=\"email\" placeholder=\"Email\" value={this.state.email} onChange={this.updateInput}/>\n                        <p className=\"validation-message\">{this.state.emailMessage}</p>\n                        <label className=\"profile-picture-label\">Profile Picture:</label>\n                        <input type=\"file\" name=\"profilePicture\" onChange={this.updateFile}/>\n                        <label className=\"username-label\">Username:</label>\n                        <input className=\"username-input\" type=\"text\" name=\"username\" placeholder=\"Username\" value={this.state.username} onChange={this.updateInput}/>\n                        <p className=\"validation-message\">{this.state.usernameMessage}</p>\n                        <label className=\"password-label\">Password:</label>\n                        <input type=\"password\" name=\"password\" placeholder=\"Password\" value={this.state.password} onChange={this.updateInput}/>\n                        <p className=\"validation-message\">{this.state.passwordMessage}</p>\n                    </form>\n                        {!this.state.valid && (\n                            <div>\n                                <button className=\"ok-button\" onClick={this.isValid}>Ok</button>\n                                <button className=\"cancel-register-button\"><Link className=\"cancel-link\" to='/'>Cancel</Link></button>\n                            </div>\n                        )}\n                        {this.state.valid && (\n                            <button className=\"register-button\" onClick={this.register}>Register</button>\n                        )}\n                        {this.state.message && (\n                            <p className=\"validation-message\">{this.state.message}</p>\n                        )}\n                </div>\n            )\n        }\n    }\n}\n\nexport default Register;"]},"metadata":{},"sourceType":"module"}